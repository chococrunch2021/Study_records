### DeadLock 개념

> 프로세스가 자원을 얻지 못해 무한정 대기하는 상태로 교착 상태라고 한다

- 프로세스 a와 b가 자원 x와 y를 모두 필요로 할 때 a는 x를 가지고 있는 상태에서
  y를 요청하고 b는 y를 가진 상태에서 x를 요청하면 두 프로세스는 무한정 대기하게 된다.

### 데드락 발생 조건

1. 상호배제 (Mutual Exclusion)

   - 자원은 한 번에 한 프로세스만이 쓸 수 있다

2. 비선점 (No preemption)

   - 다른 프로세스가 사용하고 있는 자원을 강제로 뺏을 수 없다

3. 점유 대기 (hold and wait)

   - 최소한 하나의 자원을 점유(사용)하고 있고 다른 프로세스가 사용하고 있는 자원을 추가로 점유하기 위해 대기하고 있어야 한다.

4. 순환 대기(Circular wait)
   - 원형으로 서로가 가진 자원을 얻기위해 대기하는 상태여야 한다

### 데드락 처리 방법

> 위의 네 가지 조건 중 하나만이라도 없애주면 된다

1. 교착 상태 예방 및 회피 (Prevention or Avoidance)

   1. 예방 방법

      - 교착 상태 발생 조건 중 하나를 제거한다
      - 자원의 낭비가 심하다

      1. 상호배제 부정 : 여러 개의 프로세스가 하나의 자원을 같이 쓸 수 있게 한다
      2. 점유 대기 부정: 프로세스가 실행되기 전 모든 자원을 할당한다
      3. 비선점 부정: 다른 프로세스가 자원을 요구하면 점유하던 자원을 반납하고 기다리게 한다
      4. 순환 대기 부정: 자원에 고유한 번호를 할당하고 순서대로 자원을 요구하도록 한다

   2. 회피 방법
      - 은행원 알고리즘
      - 다익스트라가 제안한 방법. 프로세스가 자원을 요구할 때 자원을 할당한 후에도 시스템이 안정된 상태인지 사전에 검사하여 교착 상태를 회피하는 방법
      - 안정상태라면 자원을 할당하고 아니면 다른 프로세스가 자원을 해지할 때까지 기다린다

2. 교착 상태 탐지 및 회복
   > 교착상태가 되도록 일단 허용하고 회복시킨다

- 비용이 많이 든다

1. 교착 상태 탐지 Detection

   - 자원 할당 그래프를 통해 탐지한다
   - 자원을 요청할 때마다 탐지알고리즘을 실행하는 것은 오버헤드가 발생한다

2. 교착 상태로부터 회복 Recovery

   - 교착 상태를 일으킨 프로세스를 종료시키거나 할당된 자원을 해지시켜 회복한다
   - 프로세스를 종료하는 방법

   1. 교착 상태 프로세스 모두 중지
   2. 교착 상태 제거될 때까지 한 프로세스씩 중지

   - 자원을 선점하는 방법

   1. 교착 상태의 프로세스가 점유하는 자원을 선점해 다른 프로세스에게 할당하며 해당 프로세스를 일시정지시키는 방법
   2. 우선 순위가 낮은 프로세스, 수행 횟수가 적은 프로세스 위주로 자원을 선점한다

---

- 출처
  - [https://jwprogramming.tistory.com/12](https://jwprogramming.tistory.com/12)
